<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ashutosh Parmar — Portfolio</title>
<style>
  :root{
    --bg:#0f172a;          /* slate-900 */
    --panel:#111827;       /* gray-900 */
    --muted:#374151;       /* gray-700 */
    --text:#e5e7eb;        /* gray-200 */
    --text-dim:#a1a1aa;    /* zinc-400 */
    --brand:#6366f1;       /* indigo-500 */
    --brand-2:#06b6d4;     /* cyan-500 */
  }
  *{box-sizing:border-box}
  html{scroll-behavior:smooth}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
    background:var(--bg); color:var(--text);
  }
  a{color:var(--brand)}
  .container{max-width:1100px; margin:0 auto; padding:0 20px}
  .btn{
    display:inline-block; padding:10px 16px; border-radius:12px; border:1px solid var(--muted);
    background:#0b1220; color:var(--text); text-decoration:none; cursor:pointer;
  }
  .btn.primary{background:var(--brand); border-color:transparent}
  .btn:hover{filter:brightness(1.06)}

  /* Header */
  header{
    position:sticky; top:0; z-index:50; backdrop-filter:saturate(180%) blur(6px);
    background:rgba(15,23,42,.75); border-bottom:1px solid #1f2937; transition:transform .25s ease;
  }
  header.hidden{transform:translateY(-100%)}
  .header-inner{padding:28px 0; text-align:center}
  .title{margin:0; font-size:34px}
  .subtitle{margin:6px 0 0; color:var(--text-dim)}
  .nav{margin-top:12px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap}

  /* Sections */
  section{padding:40px 0}
  section.alt{background:#0a0f1d}
  h2{margin:0 0 18px; font-size:28px}

  /* Cards / tiles */
  .tile{
    background:rgba(17,24,39,.9); border:1px solid var(--muted); border-radius:18px;
    padding:18px; transition:border-color .2s ease, transform .2s ease;
  }
  .tile:hover{border-color:#475569; transform:translateY(-1px)}
  .tile-head{display:flex; gap:12px; align-items:flex-start; text-align:left}
  .chip{display:inline-block; padding:2px 8px; font-size:12px; border-radius:999px; border:1px solid var(--muted); background:#0a0f1d; color:#cbd5e1}

  /* Vertical timeline */
  .vline-wrap{position:relative}
  .vline{position:absolute; left:14px; top:0; bottom:0; width:3px; background:linear-gradient(#6366f1,#a855f7,#06b6d4); border-radius:2px}
  .node{position:absolute; left:8px; margin-top:7px; width:14px; height:14px; border-radius:50%; background:#fff; border:1px solid #334155}
  .tl-item{position:relative; padding-left:40px; margin-bottom:16px}

  /* Expand / collapse */
  .tile-toggle{all:unset; cursor:pointer; display:block; width:100%}
  .tile-content{display:none; margin-top:10px}
  .tile.open .tile-content{display:block}

  /* Grids */
  .grid{display:grid; gap:16px}
  .grid.two{grid-template-columns:repeat(2,minmax(0,1fr))}
  .grid.three{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:780px){ .grid.two,.grid.three{grid-template-columns:1fr} }

  /* Ratio boxes for uniform covers (16:9) and thumbs (4:3) */
  .ratio{position:relative; width:100%; overflow:hidden; border-radius:14px; border:1px solid var(--muted); background:#000}
  .r16x9{padding-bottom:56.25%}
  .r4x3{padding-bottom:75%}
  .ratio > img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover}

  /* Image box that keeps same height and fits any image (no crop) */
  .image-box{position:relative; width:100%; height:300px; background:#000; border:1px solid var(--muted); border-radius:14px; display:flex; align-items:center; justify-content:center; overflow:hidden}
  .image-box > img{max-width:100%; max-height:100%; object-fit:contain}

  /* Auto-fit (full-width, variable height) */
  .auto-fit{display:block; width:100%; background:#000; border:1px solid var(--muted); border-radius:14px; overflow:hidden}
  .auto-fit img{display:block; width:100%; height:auto; object-fit:contain}

  /* Lists */
  ul.clean{list-style:disc; padding-left:18px; margin:8px 0}
  .muted{color:var(--text-dim)}
  .pill{display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px; background:#0a0f1d; border:1px solid var(--muted); font-size:12px; color:#cbd5e1}

  /* Lightbox */
  .lightbox{position:fixed; inset:0; background:rgba(0,0,0,.8); display:none; align-items:center; justify-content:center; z-index:100}
  .lightbox.open{display:flex}
  .lb-inner{position:relative; width:min(96vw,1100px)}
  .lb-img{width:100%; height:75vh; background:#000; object-fit:contain; border-radius:14px}
  .lb-btn{position:absolute; top:8px; background:rgba(255,255,255,.12); border:0; color:#fff; padding:8px 10px; border-radius:10px; cursor:pointer}
  .lb-close{right:8px}
  .lb-prev{left:8px; top:50%; transform:translateY(-50%)}
  .lb-next{right:8px; top:50%; transform:translateY(-50%)}
  .lb-count{position:absolute; bottom:10px; left:0; right:0; text-align:center; color:#e2e8f0}

  footer{border-top:1px solid #1f2937; padding:26px 0; color:#9ca3af; text-align:center}
</style>
</head>
<body>

<header id="siteHeader">
  <div class="container header-inner">
    <h1 class="title">Ashutosh Parmar</h1>
    <p class="subtitle">Mechanical Engineer • Product Design • Robotics</p>
    <nav class="nav">
      <a class="btn" href="#about">About</a>
      <a class="btn" href="#education">Education</a>
      <a class="btn" href="#experience">Experience</a>
      <a class="btn" href="#projects">Projects</a>
      <a class="btn primary" href="#contact">Contact</a>
    </nav>
  </div>
</header>

<main>

  <!-- About -->
  <section id="about">
    <div class="container">
      <h2>About Me</h2>
      <div class="tile">
        <p class="muted" style="margin:0">
          Final-year Mechanical Engineering student focused on product design, robotics, and manufacturing systems.
          I work across CAD/FEA, Digital Twin simulations (MATLAB/Simulink), and rapid prototyping to ship reliable, manufacturable designs.
        </p>
      </div>
    </div>
  </section>

  <!-- Education -->
  <section id="education" class="alt">
    <div class="container">
      <h2>Education</h2>
      <div class="tile">
        <div class="tile-head">
          <div>
            <h3 style="margin:0 0 4px">VIT Vellore</h3>
            <div class="muted">B.Tech in Mechanical Engineering • 2021 – 2025</div>
            <ul class="clean">
              <li>Focus: Product Design, Robotics, and Digital Twin.</li>
              <li>Notable work: Digital Twin of UR5, Smart Steam Trap, 3D-Printed Drone.</li>
              <li>Awards: IRDC 2022 (1st), IRC 2023 (2nd), VIT Special Achiever.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- EXPERIENCE (kept as before; vertical timeline; expand) -->
  <section id="experience">
    <div class="container">
      <h2>Experience</h2>

      <div class="vline-wrap">
        <div class="vline"></div>

        <div class="tl-item">
          <span class="node"></span>
          <div class="tile">
            <button class="tile-toggle" aria-expanded="false">
              <h3 style="margin:0 0 4px">Whirlpool Corporation</h3>
              <div class="muted">Product Design Intern <strong> Pune, India </strong> • Jan 2025 - July 2025</div>
              <p class="muted" style="margin:8px 0 0">
                Worked on laundry & dispenser systems. 3 patents + 1 trade secret (under review).
              </p>
            </button>
            <div class="tile-content">
              <ul class="clean">
                <li>Design iterations for dispenser sub-assemblies (reliability & manufacturability).</li>
                <li>DFMEA and tolerance studies to de-risk before EVT.</li>
                <li>Supplier collaboration for DFM & cost-down proposals.</li>
              </ul>

              <!-- LOGO/IMAGE: fixed-height box fits any dimension (no crop) -->
              <!-- Slideshow (any image sizes) -->
<div class="slider"
     data-images='["images/whirlpool/1.jpg","images/whirlpool/2.jpg","images/whirlpool/3.jpg"]'>
  <button class="s-btn s-prev" aria-label="Previous">←</button>
  <button class="s-btn s-next" aria-label="Next">→</button>
  <div class="s-count"></div>
</div>


            </div>
          </div>
        </div>

        <div class="tl-item">
          <span class="node"></span>
          <div class="tile">
            <button class="tile-toggle" aria-expanded="false">
              <h3 style="margin:0 0 4px">Orangewood Labs (YC)</h3>
              <div class="muted">Robotics Intern • 2019–2021, 2021–2025</div>
              <p class="muted" style="margin:8px 0 0">
                Digital Twin of UR5 for kinematics/dynamics, trajectory planning, computed-torque control.
              </p>
            </button>
            <div class="tile-content">
              <ul class="clean">
                <li>Trapezoidal profiles; IK & Jacobian controllers.</li>
                <li>Friction & energy modeling; validated on UR5 logs.</li>
                <li>Waypoint → joint trajectory tooling.</li>
              </ul>
              <!-- Uniform 4:3 thumbs (any image dims will look consistent) -->
              <div class="grid three" data-gallery>
                <div class="ratio r4x3"><img src="images/orangewood/1.jpg" alt=""></div>
                <div class="ratio r4x3"><img src="images/orangewood/2.jpg" alt=""></div>
                <div class="ratio r4x3"><img src="images/projects/dtwin/1.jpg" alt=""></div>
              </div>
            </div>
          </div>
        </div>

        <div class="tl-item">
          <span class="node"></span>
          <div class="tile">
            <button class="tile-toggle" aria-expanded="false">
              <h3 style="margin:0 0 4px">InsideFPV</h3>
              <div class="muted">Product Design Intern • May–Nov 2023</div>
              <p class="muted" style="margin:8px 0 0">Defense drone design • CAD → AM → testing • Kaizen iterations.</p>
            </button>
            <div class="tile-content">
              <ul class="clean">
                <li>Topology-optimized arms, weight-to-stiffness lattices.</li>
                <li>Iterated cooling, arm quick-release; field-tested.</li>
              </ul>
              <div class="grid three" data-gallery>
                <div class="ratio r4x3"><img src="images/projects/drone/1.jpg" alt=""></div>
                <div class="ratio r4x3"><img src="images/projects/drone/2.jpg" alt=""></div>
                <div class="ratio r4x3"><img src="images/projects/drone/3.jpg" alt=""></div>
              </div>
            </div>
          </div>
        </div>

        <div class="tl-item">
          <span class="node"></span>
          <div class="tile">
            <button class="tile-toggle" aria-expanded="false">
              <h3 style="margin:0 0 4px">Team RoverX – VIT Vellore</h3>
              <div class="muted">Mechanical Core Member • 2022–2023</div>
              <p class="muted" style="margin:8px 0 0">Rover mechanisms, drivetrain, and integration for competitions.</p>
            </button>
            <div class="tile-content">
              <ul class="clean">
                <li>Rocker-bogie elements, wheel hubs for harsh terrain.</li>
                <li>Optimized reductions & belt drives for torque/efficiency.</li>
              </ul>
              <!-- Rover photo in uniform 4:3 thumbs + optional auto-fit full-width -->
              <div class="grid three" data-gallery>
                <div class="ratio r4x3"><img src="images/rover.png" alt="Rover"></div>
                <div class="ratio r4x3"><img src="images/rover.jpg" alt="Rover alt"></div>
                <div class="ratio r4x3"><img src="images/rover.jpg" alt="Rover alt 2"></div>
              </div>
              <!-- If you want a full-width adaptive box for a hero shot, use this instead: -->
              <!-- <div class="auto-fit" style="margin-top:12px"><img src="images/rover.jpg" alt="Rover full"></div> -->
            </div>
          </div>
        </div>

      </div><!-- /vline-wrap -->
    </div>
  </section>

  <!-- PROJECTS (back to after Experience; only image optimization applied) -->
  <section id="projects" class="alt">
    <div class="container">
      <h2>Projects</h2>

      <div class="grid two">
        <div class="tile">
          <button class="tile-toggle" aria-expanded="false">
            <!-- Uniform 16:9 cover regardless of source image size -->
            <div class="ratio r16x9"><img src="images/projects/dtwin/1.jpg" alt="Digital Twin cover"></div>
            <h3 style="margin:14px 0 4px">Digital Twin of UR5 Robot</h3>
            <div class="muted">Trajectory planning, IK, dynamics; energy efficiency assessment.</div>
            <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
              <span class="pill">MATLAB</span><span class="pill">Simulink</span><span class="pill">Kinematics</span>
            </div>
          </button>
          <div class="tile-content">
            <ul class="clean">
              <li>6-DOF rigid body tree, waypoint planner (Cartesian → joint space).</li>
              <li>Computed-torque control with viscous/Coulomb friction modeling.</li>
              <li>Compared simulation vs. physical UR5 logs for validation.</li>
            </ul>
            <!-- Uniform 4:3 thumbnails open in lightbox -->
            <div class="grid three" data-gallery>
              <div class="ratio r4x3"><img src="images/projects/dtwin/1.jpg" alt=""></div>
              <div class="ratio r4x3"><img src="images/projects/dtwin/2.jpg" alt=""></div>
              <div class="ratio r4x3"><img src="images/projects/dtwin/3.jpg" alt=""></div>
            </div>
          </div>
        </div>

        <div class="tile">
          <button class="tile-toggle" aria-expanded="false">
            <div class="ratio r16x9"><img src="images/projects/steam/1.jpg" alt="Smart Steam Trap cover"></div>
            <h3 style="margin:14px 0 4px">Smart Steam Trap</h3>
            <div class="muted">Industrial IoT controls; reduced steam loss vs mechanical trap.</div>
            <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
              <span class="pill">Industrial IoT</span><span class="pill">Controls</span>
            </div>
          </button>
          <div class="tile-content">
            <ul class="clean">
              <li>Differential sensing + solenoid actuation with fail-safe bypass.</li>
              <li>Bench tests confirm lower steam losses.</li>
            </ul>
            <div class="grid three" data-gallery>
              <div class="ratio r4x3"><img src="images/projects/steam/1.jpg" alt=""></div>
              <div class="ratio r4x3"><img src="images/projects/steam/2.jpg" alt=""></div>
              <div class="ratio r4x3"><img src="images/projects/steam/1.jpg" alt=""></div>
            </div>
          </div>
        </div>

        <div class="tile">
          <button class="tile-toggle" aria-expanded="false">
            <div class="ratio r16x9"><img src="images/projects/drone/1.jpg" alt="3D Printed Drone cover"></div>
            <h3 style="margin:14px 0 4px">3D-Printed Drone</h3>
            <div class="muted">Lightweight AM drone; runner-up at AM Hackathon.</div>
            <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
              <span class="pill">AM</span><span class="pill">Aero</span>
            </div>
          </button>
          <div class="tile-content">
            <ul class="clean">
              <li>Topology-optimized arms; vibration isolation for FC.</li>
              <li>Rapid print-test-iterate loop (PLA-CF, PETG).</li>
            </ul>
            <div class="grid three" data-gallery>
              <div class="ratio r4x3"><img src="images/projects/drone/1.jpg" alt=""></div>
              <div class="ratio r4x3"><img src="images/projects/drone/2.jpg" alt=""></div>
              <div class="ratio r4x3"><img src="images/projects/drone/3.jpg" alt=""></div>
            </div>
          </div>
        </div>

        <div class="tile">
          <button class="tile-toggle" aria-expanded="false">
            <div class="ratio r16x9"><img src="images/projects/wheel/1.jpg" alt="Wheelbarrow FEA cover"></div>
            <h3 style="margin:14px 0 4px">FEA of Wheelbarrow</h3>
            <div class="muted">Stress distribution & safety factor for load cases.</div>
            <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
              <span class="pill">SolidWorks</span><span class="pill">FEA</span>
            </div>
          </button>
          <div class="tile-content">
            <ul class="clean">
              <li>Meshed frame & tray; realistic boundary conditions.</li>
              <li>Identified hotspots; suggested ribs/material changes.</li>
            </ul>
            <div class="grid three" data-gallery>
              <div class="ratio r4x3"><img src="images/projects/wheel/1.jpg" alt=""></div>
              <div class="ratio r4x3"><img src="images/projects/wheel/2.jpg" alt=""></div>
              <div class="ratio r4x3"><img src="images/projects/wheel/1.jpg" alt=""></div>
            </div>
          </div>
        </div>

        <div class="tile">
          <button class="tile-toggle" aria-expanded="false">
            <div class="ratio r16x9"><img src="images/projects/gear/1.jpg" alt="Sun & Planet Gear cover"></div>
            <h3 style="margin:14px 0 4px">Sun & Planet Gear Design</h3>
            <div class="muted">Torque & efficiency analysis; contact stresses and backlash.</div>
            <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
              <span class="pill">Gear Design</span><span class="pill">Kinematics</span>
            </div>
          </button>
          <div class="tile-content">
            <ul class="clean">
              <li>Ratios, contact stress, backlash targets.</li>
              <li>Efficiency vs. lubrication & material.</li>
            </ul>
            <div class="grid three" data-gallery>
              <div class="ratio r4x3"><img src="images/projects/gear/1.jpg" alt=""></div>
              <div class="ratio r4x3"><img src="images/projects/gear/2.jpg" alt=""></div>
              <div class="ratio r4x3"><img src="images/projects/gear/1.jpg" alt=""></div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- Awards -->
  <section>
    <div class="container">
      <h2>Awards & Achievements</h2>
      <div class="grid two">
        <div class="tile"><strong>International Rover Design Challenge – 1st Worldwide</strong><div class="muted">2022</div></div>
        <div class="tile"><strong>International Rover Challenge – 2nd Worldwide (Bengaluru)</strong><div class="muted">2023</div></div>
        <div class="tile"><strong>Special Achiever Award – VIT Vellore</strong><div class="muted">2023</div></div>
        <div class="tile"><strong>Additive Manufacturing Hackathon – Runner-up</strong><div class="muted">3D-Printed Drone • 2023</div></div>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="alt">
    <div class="container">
      <h2>Contact</h2>
      <div class="grid two">
        <div class="tile">
          <div><div class="muted">Email</div><a href="mailto:your.email@domain.com">your.email@domain.com</a></div>
          <div style="margin-top:10px"><div class="muted">LinkedIn</div><a href="#">linkedin.com/in/your-handle</a></div>
          <div style="margin-top:10px"><div class="muted">GitHub</div><a href="#">github.com/your-handle</a></div>
          <button class="btn primary" style="margin-top:12px" id="quickEmail">Quick Email</button>
        </div>

        <form class="tile" id="contactForm">
          <label class="muted">Name</label>
          <input name="name" required style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--muted);background:#0b1220;color:var(--text);margin:6px 0 10px">
          <label class="muted">Email</label>
          <input type="email" name="email" required style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--muted);background:#0b1220;color:var(--text);margin:6px 0 10px">
          <label class="muted">Message</label>
          <textarea name="message" rows="4" required style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--muted);background:#0b1220;color:var(--text);margin:6px 0 12px"></textarea>
          <button class="btn" type="submit">Send</button>
        </form>
      </div>
      <p class="muted" style="font-size:12px;margin-top:8px">
        Put files in <code>images/</code>. Covers use a uniform 16:9 box; thumbnails are 4:3; logos/photos inside details use the fixed
        <code>.image-box</code> (no crop). Lightbox shows full image with <em>contain</em>.
      </p>
    </div>
  </section>

</main>

<footer>
  © 2025 Ashutosh Parmar • Portfolio
</footer>

<!-- Lightbox -->
<div class="lightbox" id="lightbox">
  <div class="lb-inner">
    <img class="lb-img" id="lbImg" alt="">
    <button class="lb-btn lb-close" id="lbClose">✕</button>
    <button class="lb-btn lb-prev" id="lbPrev">←</button>
    <button class="lb-btn lb-next" id="lbNext">→</button>
    <div class="lb-count" id="lbCount"></div>
  </div>
</div>

<script>
  // Hide header on scroll down, show on scroll up
  (function(){
    const header = document.getElementById('siteHeader');
    let lastY = 0;
    window.addEventListener('scroll', () => {
      const y = window.scrollY || 0;
      const down = y > lastY;
      const nearTop = y < 24;
      header.classList.toggle('hidden', down && !nearTop);
      lastY = y;
    }, {passive:true});
  })();

  // Expand/collapse tiles (experience + projects)
  document.querySelectorAll('.tile .tile-toggle').forEach(btn => {
    btn.addEventListener('click', () => {
      const tile = btn.closest('.tile');
      const open = tile.classList.toggle('open');
      btn.setAttribute('aria-expanded', open ? 'true' : 'false');
    });
  });

  // Lightbox for any grid with data-gallery
  (function(){
    const lb = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const lbCount = document.getElementById('lbCount');
    const prev = document.getElementById('lbPrev');
    const next = document.getElementById('lbNext');
    const close = document.getElementById('lbClose');

    let currentList = [];
    let idx = 0;

    function open(list, i){
      currentList = list; idx = i;
      render(); lb.classList.add('open');
    }
    function render(){
      lbImg.src = currentList[idx];
      lbCount.textContent = (idx+1) + ' / ' + currentList.length;
    }
    function nav(d){ idx = (idx + d + currentList.length) % currentList.length; render(); }

    document.querySelectorAll('[data-gallery]').forEach(g => {
      const imgs = Array.from(g.querySelectorAll('img'));
      imgs.forEach((img, i) => {
        img.style.cursor = 'pointer';
        img.addEventListener('click', () => open(imgs.map(n => n.src), i));
      });
    });

    prev.onclick = () => nav(-1);
    next.onclick = () => nav(1);
    close.onclick = () => lb.classList.remove('open');
    lb.addEventListener('click', (e)=>{ if(e.target === lb) lb.classList.remove('open'); });
    document.addEventListener('keydown', (e)=>{
      if(!lb.classList.contains('open')) return;
      if(e.key === 'Escape') lb.classList.remove('open');
      if(e.key === 'ArrowLeft') nav(-1);
      if(e.key === 'ArrowRight') nav(1);
    });
  })();

  // Contact actions
  document.getElementById('quickEmail')?.addEventListener('click', () => {
    const subject = encodeURIComponent('Portfolio inquiry');
    const body = encodeURIComponent('Hi Ashutosh,\n\nI saw your portfolio and would like to discuss ...\n\nThanks,');
    location.href = 'mailto:your.email@domain.com?subject='+subject+'&body='+body;
  });
  document.getElementById('contactForm')?.addEventListener('submit', (e)=>{
    e.preventDefault();
    const f = e.currentTarget;
    const subject = encodeURIComponent('Message from ' + f.name.value);
    const body = encodeURIComponent(f.message.value + '\n\nRespond to: ' + f.email.value);
    location.href = 'mailto:your.email@domain.com?subject='+subject+'&body='+body;
  });
</script>
</body>
</html>
<script>
document.addEventListener('DOMContentLoaded', function () {
  // --- Slideshow wiring (robust parser + logs) ---
  function parseImagesAttr(el) {
    // Prefer valid JSON in data-images='["a","b"]'
    let raw = el.getAttribute('data-images') || '';
    if (!raw) return [];
    try {
      return JSON.parse(raw);
    } catch (e) {
      // Fallback: accept comma-separated list without JSON
      // e.g., data-images="images/a.jpg, images/b.jpg"
      console.warn('JSON parse failed for data-images, falling back to CSV:', raw, e);
      return raw.split(',').map(s => s.trim()).filter(Boolean);
    }
  }

  document.querySelectorAll('.slider').forEach(slider => {
    const list = parseImagesAttr(slider);
    if (!Array.isArray(list) || list.length === 0) {
      console.error('Slider has no images:', slider);
      return;
    }

    // Create <img> element if missing
    let img = slider.querySelector('img');
    if (!img) {
      img = document.createElement('img');
      slider.prepend(img);
    }

    const count = slider.querySelector('.s-count');
    const prev = slider.querySelector('.s-prev');
    const next = slider.querySelector('.s-next');

    let i = 0;
    function render() {
      img.src = list[i];
      if (count) count.textContent = (i + 1) + ' / ' + list.length;
    }
    function nav(d) { i = (i + d + list.length) % list.length; render(); }

    prev && prev.addEventListener('click', (e) => { e.stopPropagation(); nav(-1); });
    next && next.addEventListener('click', (e) => { e.stopPropagation(); nav(1); });

    // Swipe
    let sx = null;
    slider.addEventListener('touchstart', (e) => { sx = e.touches[0].clientX; }, { passive: true });
    slider.addEventListener('touchend', (e) => {
      if (sx == null) return;
      const dx = e.changedTouches[0].clientX - sx;
      if (Math.abs(dx) > 40) nav(dx < 0 ? 1 : -1);
      sx = null;
    }, { passive: true });

    render();
  });
});
</script>
